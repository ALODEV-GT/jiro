<div class="min-h-screen">
    <!-- Project info here -->
    @if (project) {
    <div class="container mx-auto px-4 py-6 mb-6">
        <div>
            <div class="flex justify-between items-start mb-6">
                <div>
                    <h1 class="text-3xl font-bold">
                        {{ project.name }}
                    </h1>
                    <p class="text-base-content/60">
                        Cliente: {{ project.client }}
                    </p>
                </div>

                @if (!isEditingProject && this.authStore.hasPermission("projects:write")) {
                <button class="btn btn-outline btn-primary" (click)="enableEdit()">
                    Editar proyecto
                </button>
                }
            </div>

            <form [formGroup]="projectForm" class="grid grid-cols-1 md:grid-cols-2 gap-6">

                <!-- Nombre -->
                <div class="form-control">
                    <label class="label">Nombre</label>
                    <input class="input input-bordered" formControlName="name" />
                </div>

                <!-- Cliente -->
                <div class="form-control">
                    <label class="label">Cliente</label>
                    <input class="input input-bordered" formControlName="client" />
                </div>

                <!-- Ingreso mensual -->
                <div class="form-control">
                    <label class="label">Ingreso mensual</label>
                    <input type="number" class="input input-bordered" formControlName="monthlyIncome" />
                </div>

                <!-- Estado -->
                <div class="form-control">
                    <label class="label">Estado</label>
                    <input class="input input-bordered" [value]="project.active ? 'Activo' : 'Cerrado'" disabled />
                </div>

                <!-- Descripción -->
                <div class="form-control md:col-span-2">
                    <label class="label">Descripción</label>
                    <textarea class="textarea textarea-bordered" formControlName="description"></textarea>
                </div>

            </form>

            @if (isEditingProject) {
            <div class="flex justify-end gap-3 mt-6">
                <button class="btn" (click)="cancelEdit()">
                    Cancelar
                </button>
                <button class="btn btn-primary" (click)="saveProject()">
                    Guardar cambios
                </button>
            </div>
            }

        </div>
    </div>
    }

    <!-- Project tabs -->
    <div class="container mx-auto px-4 pb-8">
        <div class="tabs tabs-bordered tabs-lg mb-8">
            <a class="tab" [class.tab-active]="activeTab === 'board'" (click)="activeTab = 'board'">
                Tablero
            </a>
            <a class="tab" [class.tab-active]="activeTab === 'sprints'" (click)="activeTab = 'sprints'">
                Sprints
            </a>
            <a class="tab" [class.tab-active]="activeTab === 'members'" (click)="activeTab = 'members'">
                Miembros
            </a>
            <a class="tab" [class.tab-active]="activeTab === 'income'" (click)="activeTab = 'income'">
                Ingresos
            </a>
            <a class="tab" [class.tab-active]="activeTab === 'expense'" (click)="activeTab = 'expense'">
                Egresos
            </a>
            <a class="tab" [class.tab-active]="activeTab === 'reports'" (click)="activeTab = 'reports'">
                Reportes
            </a>
        </div>

        <!-- Tabs content -->
        <div class=" min-h-[60vh]">

            @if (activeTab === 'board') {
            <div class="text-center">
                <app-board></app-board>
            </div>
            }

            @if (activeTab === 'members') {
            @if (project) {
            <app-member-management [projectId]="project.id"></app-member-management>
            }
            }

            @if (activeTab === 'sprints') {
            <div class="text-center">
                <app-sprints></app-sprints>
            </div>
            }

            @if (activeTab === 'income') {
            <div>
                @if (project) {
                <app-incoming-management [projectId]="project.id"></app-incoming-management>
                }
            </div>
            }

            @if (activeTab === 'expense') {
            <div class="text-center py-20">
                @if (project) {
                <app-expense-management [projectId]="project.id"></app-expense-management>
                }
            </div>
            }

            @if (activeTab === 'reports') {
            <div class="text-center py-20">
                <h2 class="text-3xl font-bold mb-4">Reportes</h2>
                <p class="text-base-content/60">Burndown chart, velocity, informes personalizados</p>
            </div>
            }
        </div>
    </div>
</div>